"use strict";

const db = require('../../config/knex');
module.exports = {
  // Admins
  findAdminByEmail: email => db('Admin').where({
    Email: email
  }).first(),
  // Dashboard metrics
  countCompanies: async () => {
    const [{
      count
    }] = await db('Company').count('*');
    return Number(count);
  },
  countUsers: async () => {
    const [{
      count
    }] = await db('UserAccount').count('*');
    return Number(count);
  },
  countWarehouses: async () => {
    const [{
      count
    }] = await db('Warehouse').count('*');
    return Number(count);
  },
  // Recent activity (last 10 logs)
  recentActivity: () => db('Log').select('id', 'Action', 'ObjectType', 'ObjectID', 'Timestamp', 'Note').orderBy('Timestamp', 'desc').limit(10)
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZmluZEFkbWluQnlFbWFpbCIsImVtYWlsIiwid2hlcmUiLCJFbWFpbCIsImZpcnN0IiwiY291bnRDb21wYW5pZXMiLCJjb3VudCIsIk51bWJlciIsImNvdW50VXNlcnMiLCJjb3VudFdhcmVob3VzZXMiLCJyZWNlbnRBY3Rpdml0eSIsInNlbGVjdCIsIm9yZGVyQnkiLCJsaW1pdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9tb2R1bGVzL2FkbWluL21vZGVscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkYiA9IHJlcXVpcmUoJy4uLy4uL2NvbmZpZy9rbmV4Jyk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAvLyBBZG1pbnNcclxuICBmaW5kQWRtaW5CeUVtYWlsOiAoZW1haWwpID0+XHJcbiAgICBkYignQWRtaW4nKS53aGVyZSh7IEVtYWlsOiBlbWFpbCB9KS5maXJzdCgpLFxyXG5cclxuICAvLyBEYXNoYm9hcmQgbWV0cmljc1xyXG4gIGNvdW50Q29tcGFuaWVzOiBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBbeyBjb3VudCB9XSA9IGF3YWl0IGRiKCdDb21wYW55JykuY291bnQoJyonKTtcclxuICAgIHJldHVybiBOdW1iZXIoY291bnQpO1xyXG4gIH0sXHJcbiAgY291bnRVc2VyczogYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgW3sgY291bnQgfV0gPSBhd2FpdCBkYignVXNlckFjY291bnQnKS5jb3VudCgnKicpO1xyXG4gICAgcmV0dXJuIE51bWJlcihjb3VudCk7XHJcbiAgfSxcclxuICBjb3VudFdhcmVob3VzZXM6IGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IFt7IGNvdW50IH1dID0gYXdhaXQgZGIoJ1dhcmVob3VzZScpLmNvdW50KCcqJyk7XHJcbiAgICByZXR1cm4gTnVtYmVyKGNvdW50KTtcclxuICB9LFxyXG5cclxuICAvLyBSZWNlbnQgYWN0aXZpdHkgKGxhc3QgMTAgbG9ncylcclxuICByZWNlbnRBY3Rpdml0eTogKCkgPT5cclxuICAgIGRiKCdMb2cnKVxyXG4gICAgICAuc2VsZWN0KCdpZCcsICdBY3Rpb24nLCAnT2JqZWN0VHlwZScsICdPYmplY3RJRCcsICdUaW1lc3RhbXAnLCAnTm90ZScpXHJcbiAgICAgIC5vcmRlckJ5KCdUaW1lc3RhbXAnLCAnZGVzYycpXHJcbiAgICAgIC5saW1pdCgxMCksXHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxFQUFFLEdBQUdDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztBQUV2Q0MsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZjtFQUNBQyxnQkFBZ0IsRUFBR0MsS0FBSyxJQUN0QkwsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDTSxLQUFLLENBQUM7SUFBRUMsS0FBSyxFQUFFRjtFQUFNLENBQUMsQ0FBQyxDQUFDRyxLQUFLLENBQUMsQ0FBQztFQUU3QztFQUNBQyxjQUFjLEVBQUUsTUFBQUEsQ0FBQSxLQUFZO0lBQzFCLE1BQU0sQ0FBQztNQUFFQztJQUFNLENBQUMsQ0FBQyxHQUFHLE1BQU1WLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQ1UsS0FBSyxDQUFDLEdBQUcsQ0FBQztJQUNsRCxPQUFPQyxNQUFNLENBQUNELEtBQUssQ0FBQztFQUN0QixDQUFDO0VBQ0RFLFVBQVUsRUFBRSxNQUFBQSxDQUFBLEtBQVk7SUFDdEIsTUFBTSxDQUFDO01BQUVGO0lBQU0sQ0FBQyxDQUFDLEdBQUcsTUFBTVYsRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDVSxLQUFLLENBQUMsR0FBRyxDQUFDO0lBQ3RELE9BQU9DLE1BQU0sQ0FBQ0QsS0FBSyxDQUFDO0VBQ3RCLENBQUM7RUFDREcsZUFBZSxFQUFFLE1BQUFBLENBQUEsS0FBWTtJQUMzQixNQUFNLENBQUM7TUFBRUg7SUFBTSxDQUFDLENBQUMsR0FBRyxNQUFNVixFQUFFLENBQUMsV0FBVyxDQUFDLENBQUNVLEtBQUssQ0FBQyxHQUFHLENBQUM7SUFDcEQsT0FBT0MsTUFBTSxDQUFDRCxLQUFLLENBQUM7RUFDdEIsQ0FBQztFQUVEO0VBQ0FJLGNBQWMsRUFBRUEsQ0FBQSxLQUNkZCxFQUFFLENBQUMsS0FBSyxDQUFDLENBQ05lLE1BQU0sQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLFlBQVksRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUNyRUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUMsQ0FDNUJDLEtBQUssQ0FBQyxFQUFFO0FBQ2YsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==